@model AspBlog.Models.Games
@{
    ViewData["Title"] = Model.Oponent;
}

<table>
    <tr>
        <th>Datum</th>
        <th>Nepřítel</th>
        <th>Skóre</th>
        <th>Místo</th>
    </tr>
    <tr>
        <td>@Model.DateOfGame</td>
        <td>@Model.Oponent</td>
        <td>@Model.Score</td>
        <td>@Model.Place</td>
    </tr>
</table>

<h3>Poznámka:</h3>
<p>@Html.Raw(Model.Describtion)</p>

<h3>Komentáře</h3>
@if (User.Identity.IsAuthenticated)
{
    <p>Přidejte komentář:</p>
    <form asp-controller="Comments" asp-action="AddComment" method="post">
        <input type="hidden" name="gamesId" value="@Model.Id" />
        <textarea name="content" required></textarea>
        <button type="submit">Přidat komentář</button>
    </form>
}
else
{
    <p>Pro přidání komentáře se musíte přihlásit.</p>
}
@if (Model.Commentars != null && Model.Commentars.Any())
{
    <ul>
        @foreach (var comment in Model.Commentars.OrderByDescending(c => c.Date))
        {
            <li>
                <strong>@comment.UserName</strong> (@comment.Date.ToString()):<br />
                @comment.Content

                @if (User.Identity.IsAuthenticated && (User.Identity.Name == comment.UserName || User.IsInRole("Admin")))
                {
                    <div>
                        <a asp-controller="Comments" asp-action="EditComment" asp-route-id="@comment.Id">Edit</a>

                        <form asp-controller="Comments" asp-action="DeleteComment" method="post" style="display:inline;">
                            <input type="hidden" name="id" value="@comment.Id" />
                            <button type="submit" onclick="return confirm('Are you sure you want to delete this comment?')">Delete</button>
                        </form>
                    </div>
                }
            </li>
        }
    </ul>
}
else
{
    <p>Zatím žádné komentáře.</p>
}

<p><a class="clanky-tlacitko" asp-action="Index">Zpět na seznam</a></p>

